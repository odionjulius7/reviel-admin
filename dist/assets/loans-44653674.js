import{j as e,x as Z,T as S,P as i,r as u,z as ee,I as C,C as k,M as R,y as te,H as ne,B as re,l as se,m as F,J as oe,K as ae,o as ie,N as le,S as ce,G as de,W as ue}from"./index-83851525.js";import{A as j}from"./app-widget-summary-ec1424ef.js";import{T as P,a as xe,b as me,c as he,d as pe,e as je}from"./TableSortLabel-56f7f481.js";import{T as x,a as fe}from"./TablePagination-8230c915.js";import{O as ge}from"./Select-169c80ae.js";import{I as be}from"./InputAdornment-7889c209.js";import{T as E}from"./Tooltip-44c969f6.js";import{M as ye}from"./Menu-92e6c40b.js";import{L as we}from"./label-544fd239.js";import{h as V}from"./moment-fbc5633a.js";import{C as Te}from"./Container-e06bc7eb.js";import{G as h}from"./Grid2-304056b8.js";import{C as ve}from"./Card-c178976c.js";import"./format-number-8ae81adc.js";import"./Popper-c3741ef0.js";import"./isMuiElement-06905c61.js";function B({query:r}){return e.jsx(P,{children:e.jsx(x,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(Z,{sx:{textAlign:"center"},children:[e.jsx(S,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(S,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',r,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}B.propTypes={query:i.string};function M({emptyRows:r,height:s}){return r?e.jsx(P,{sx:{...s&&{height:s*r}},children:e.jsx(x,{colSpan:9})}):null}M.propTypes={emptyRows:i.number,height:i.number};function W({numSelected:r,setPostStatus:s,filterName:a,onFilterName:c}){const[t,l]=u.useState(null),d=m=>{l(m.currentTarget)},o=()=>{l(null)};return e.jsxs(ee,{sx:{height:96,display:"flex",justifyContent:"space-between",p:m=>m.spacing(0,1,0,3),...r>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[r>0?e.jsxs(S,{component:"div",variant:"subtitle1",children:[r," selected"]}):e.jsx(ge,{value:a,onChange:c,placeholder:"Search loan id...",startAdornment:e.jsx(be,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),r>0?e.jsx(E,{title:"Delete",children:e.jsx(k,{children:e.jsx(C,{icon:"eva:trash-2-fill"})})}):e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Filter list",children:e.jsx(k,{onClick:d,children:e.jsx(C,{icon:"ic:round-filter-list"})})}),e.jsxs(ye,{anchorEl:t,open:!!t,onClose:o,children:[e.jsx(R,{onClick:()=>{s("active"),o()},children:"Active"}),e.jsx(R,{onClick:()=>{s("completed"),o()},children:"Completed"})]})]})]})}W.propTypes={numSelected:i.number,setPostStatus:i.any,filterName:i.string,onFilterName:i.func};function q({selected:r,lender:s,borrower:a,loanAmount:c,expectedReturn:t,status:l,balance:d,initiationDate:o,dueDate:m,creditId:w,key:f}){const[g,b]=u.useState(null),T=()=>{b(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(P,{hover:!0,tabIndex:-1,role:"checkbox",selected:r,children:[e.jsx(x,{align:"center",children:e.jsx(te,{to:`/loan/${w}`,children:w})}),e.jsx(x,{align:"center",children:s}),e.jsx(x,{align:"center",children:a}),e.jsx(x,{align:"center",children:new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(c)}),e.jsx(x,{align:"center",children:new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(t)}),e.jsx(x,{align:"center",children:new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(d)}),e.jsx(x,{align:"center",children:V(o).format("L")}),e.jsx(x,{align:"center",children:V(m).format("L")}),e.jsx(x,{align:"center",children:e.jsx(we,{color:l==="bad"&&"error"||l==="active"&&"warning"||l==="inactive"&&"warning"||"success",children:l})})]},f),e.jsx(ne,{open:!!g,anchorEl:g,onClose:T,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:e.jsxs(R,{onClick:T,sx:{color:"error.main"},children:[e.jsx(C,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})})]})}q.propTypes={lender:i.any,borrower:i.any,loanAmount:i.any,expectedReturn:i.any,selected:i.any,status:i.string,balance:i.any,initiationDate:i.any,dueDate:i.any,creditId:i.any,key:i.any};const Le={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Ce(r,s,a){return r?Math.max(0,(1+r)*s-a):0}function G(r,s,a){return r[a]===null?1:s[a]===null||s[a]<r[a]?-1:s[a]>r[a]?1:0}function Se(r,s){return r==="desc"?(a,c)=>G(a,c,s):(a,c)=>-G(a,c,s)}function Pe({inputData:r,comparator:s,filterName:a}){const c=r.map((t,l)=>[t,l]);return c.sort((t,l)=>{const d=s(t[0],l[0]);return d!==0?d:t[1]-l[1]}),r=c.map(t=>t[0]),a&&(r=r.filter(t=>t.name.toLowerCase().indexOf(a.toLowerCase())!==-1)),r}function z({order:r,orderBy:s,rowCount:a,headLabel:c,numSelected:t,onRequestSort:l}){const d=o=>m=>{l(m,o)};return e.jsx(xe,{children:e.jsx(P,{children:c.map(o=>e.jsx(x,{align:o.align||"left",sortDirection:s===o.id?r:!1,sx:{width:o.width,minWidth:o.minWidth},children:e.jsxs(me,{hideSortIcon:!0,active:s===o.id,direction:s===o.id?r:"asc",onClick:d(o.id),children:[o.label,s===o.id?e.jsx(re,{sx:{...Le},children:r==="desc"?"sorted descending":"sorted ascending"}):null]})},o.id))})})}z.propTypes={order:i.oneOf(["asc","desc"]),orderBy:i.string,rowCount:i.number,headLabel:i.array,numSelected:i.number,onRequestSort:i.func};function Ie(){var D,O;const r=se(),s=F(n=>n.loan),a=F(n=>n),c=(O=(D=a==null?void 0:a.auth.user)==null?void 0:D.data)==null?void 0:O.token,t=s==null?void 0:s.loanMetrics;function l(n){return n/100}const d=(s==null?void 0:s.loans)||[],o=d==null?void 0:d.map((n,p)=>{const L={creditId:n.id,lender:n.lender_first_name,borrower:n.borrower_first_name,loanAmount:l(n.amount),expectedReturn:l(n.expected_return),balance:(l(n.expected_return)??0)-(l(n==null?void 0:n.amount_paid)??0),initiationDate:n.createdAt,dueDate:n.due_date,status:n.status?"completed":"active"};return L.index=p,L}),[m,w]=u.useState(""),[f,g]=u.useState(0),[b,T]=u.useState("asc"),[I,H]=u.useState("name"),[N,Ne]=u.useState(""),[y,U]=u.useState(5),K=(n,p)=>{p!==""&&(T(I===p&&b==="asc"?"desc":"asc"),H(p))},J=(n,p)=>{g(p)},_=n=>{g(0),U(parseInt(n.target.value,10))},A=Pe({inputData:o,comparator:Se(b,I),filterName:N}),$=!A.length&&!!N,[v,Q]=u.useState("");u.useEffect(()=>{let n;return v.trim()!==""&&(clearTimeout(n),n=setTimeout(()=>{r(oe({creditid:v,token:c}))},2e3)),()=>{clearTimeout(n)}},[v,r,c]);const X=n=>{Q(n.target.value)},Y=n=>{w(n)};return u.useEffect(()=>{r(ae({item:m,token:c}))},[m,r,c]),u.useEffect(()=>{r(ie(c)),r(le(c))},[r,c]),e.jsxs(Te,{children:[e.jsx(ce,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(S,{variant:"h4",children:"Loans"})}),e.jsxs(h,{container:!0,spacing:2,sx:{margin:"1rem 0 4rem 0"},children:[e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Total Vol. of loans",total:((t==null?void 0:t.loans_active)||0)+((t==null?void 0:t.loans_due)||0)+((t==null?void 0:t.loans_pending)||0)+((t==null?void 0:t.loans_completed)||0),color:"info"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Vol. Of Over Due Loans",total:(t==null?void 0:t.loans_due)||.001,color:"error"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Value Of Loans Initiated By Lender",total:l(t==null?void 0:t.total_amount_initiated_lender)||.001,color:"warning"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Vol. Of Pending Loans",total:(t==null?void 0:t.loans_pending)||.001,color:"success"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Vol. Completed Loans",total:(t==null?void 0:t.loans_completed)||.001,color:"success"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Value Of Loans Initiated By Borrower",total:l(t==null?void 0:t.total_amount_initiated_borrower)||.001,color:"success"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Vol. Of Active Loans",total:(t==null?void 0:t.loans_active)||.001,color:"info"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Vol. Of Loans Initiated By Lender",total:(t==null?void 0:t.lender_initiated)||.001,color:"info"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Vol. Of Loans Initiated By Borrower",total:(t==null?void 0:t.borrower_initiated)||.001,color:"info"})})]}),e.jsxs(ve,{children:[e.jsx(W,{setPostStatus:Y,filterName:v,onFilterName:X}),e.jsx(de,{children:e.jsx(he,{sx:{overflow:"unset"},children:e.jsxs(pe,{sx:{minWidth:800},children:[e.jsx(z,{order:b,orderBy:I,rowCount:o==null?void 0:o.length,onRequestSort:K,headLabel:[{id:"creditId",label:"Loan ID",align:"center"},{id:"lender",label:"Lender"},{id:"borrower",label:"Borrower"},{id:"loanAmount",label:"Loan Value"},{id:"expectedReturn",label:"Expected Return"},{id:"balance",label:"Balance",align:"center"},{id:"initiationDate",label:"Initiation Date",align:"center"},{id:"dueDate",label:"Due Date"},{id:"status",label:"Status"},{id:""}]}),e.jsxs(je,{children:[A.slice(f*y,f*y+y).map(n=>e.jsx(q,{creditId:n.creditId,lender:n.lender,borrower:n.borrower,loanAmount:n.loanAmount,expectedReturn:n.expectedReturn,status:n.status,balance:n.balance,initiationDate:n.initiationDate,dueDate:n.dueDate},n.creaditId)),e.jsx(M,{height:77,emptyRows:Ce(f,y,o==null?void 0:o.length)}),$&&e.jsx(B,{query:N})]})]})})}),e.jsx(fe,{page:f,component:"div",count:o==null?void 0:o.length,rowsPerPage:y,onPageChange:J,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:_})]})]})}function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(ue,{children:e.jsx("title",{children:" Reviel | Loan List "})}),e.jsx(Ie,{})]})}export{Ke as default};
