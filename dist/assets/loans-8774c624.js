import{j as e,x as Z,T as C,P as a,r as u,z as ee,I as N,C as k,M as A,y as te,H as ne,B as re,l as se,m as F,J as oe,K as ie,o as ae,N as ce,S as le,G as de,W as ue}from"./index-1f4d2e49.js";import{A as j}from"./app-widget-summary-965d9d3e.js";import{T as S,a as xe,b as me,c as he,d as pe,e as je}from"./TableSortLabel-ed0d5fca.js";import{T as x,a as fe}from"./TablePagination-8c547f3e.js";import{O as ge}from"./Select-5c7c0324.js";import{I as be}from"./InputAdornment-b6fbb70b.js";import{T as E}from"./Tooltip-5e61c1a6.js";import{M as ye}from"./Menu-0fad4b14.js";import{L as we}from"./label-1181e1b5.js";import{h as G}from"./moment-fbc5633a.js";import{C as Te}from"./Container-1f2010f6.js";import{G as h}from"./Grid2-d7f816cf.js";import{C as ve}from"./Card-4a9a836c.js";import"./format-number-219b9419.js";import"./Popper-db2d984a.js";import"./isMuiElement-3a78cbf0.js";function M({query:r}){return e.jsx(S,{children:e.jsx(x,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(Z,{sx:{textAlign:"center"},children:[e.jsx(C,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(C,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',r,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}M.propTypes={query:a.string};function W({emptyRows:r,height:s}){return r?e.jsx(S,{sx:{...s&&{height:s*r}},children:e.jsx(x,{colSpan:9})}):null}W.propTypes={emptyRows:a.number,height:a.number};function q({numSelected:r,setPostStatus:s,filterName:i,onFilterName:l}){const[t,c]=u.useState(null),d=m=>{c(m.currentTarget)},o=()=>{c(null)};return e.jsxs(ee,{sx:{height:96,display:"flex",justifyContent:"space-between",p:m=>m.spacing(0,1,0,3),...r>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[r>0?e.jsxs(C,{component:"div",variant:"subtitle1",children:[r," selected"]}):e.jsx(ge,{value:i,onChange:l,placeholder:"Search loan id...",startAdornment:e.jsx(be,{position:"start",children:e.jsx(N,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),r>0?e.jsx(E,{title:"Delete",children:e.jsx(k,{children:e.jsx(N,{icon:"eva:trash-2-fill"})})}):e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Filter list",children:e.jsx(k,{onClick:d,children:e.jsx(N,{icon:"ic:round-filter-list"})})}),e.jsxs(ye,{anchorEl:t,open:!!t,onClose:o,children:[e.jsx(A,{onClick:()=>{s("active"),o()},children:"Active"}),e.jsx(A,{onClick:()=>{s("completed"),o()},children:"Completed"})]})]})]})}q.propTypes={numSelected:a.number,setPostStatus:a.any,filterName:a.string,onFilterName:a.func};function z({selected:r,lender:s,borrower:i,loanAmount:l,expectedReturn:t,status:c,balance:d,initiationDate:o,dueDate:m,creditId:w,key:f}){const[g,b]=u.useState(null),T=()=>{b(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(S,{hover:!0,tabIndex:-1,role:"checkbox",selected:r,children:[e.jsx(x,{align:"center",children:e.jsx(te,{to:`/loan/${w}`,children:w})}),e.jsx(x,{align:"center",children:s}),e.jsx(x,{align:"center",children:i}),e.jsx(x,{align:"center",children:new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(l)}),e.jsx(x,{align:"center",children:new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(t)}),e.jsx(x,{align:"center",children:new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(d)}),e.jsx(x,{align:"center",children:G(o).format("L")}),e.jsx(x,{align:"center",children:G(m).format("L")}),e.jsx(x,{align:"center",children:e.jsx(we,{color:c==="bad"&&"error"||c==="active"&&"warning"||c==="inactive"&&"warning"||"success",children:c})})]},f),e.jsx(ne,{open:!!g,anchorEl:g,onClose:T,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:e.jsxs(A,{onClick:T,sx:{color:"error.main"},children:[e.jsx(N,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})})]})}z.propTypes={lender:a.any,borrower:a.any,loanAmount:a.any,expectedReturn:a.any,selected:a.any,status:a.string,balance:a.any,initiationDate:a.any,dueDate:a.any,creditId:a.any,key:a.any};const Le={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Ne(r,s,i){return r?Math.max(0,(1+r)*s-i):0}function B(r,s,i){return r[i]===null?1:s[i]===null||s[i]<r[i]?-1:s[i]>r[i]?1:0}function Ce(r,s){return r==="desc"?(i,l)=>B(i,l,s):(i,l)=>-B(i,l,s)}function Se({inputData:r,comparator:s,filterName:i}){const l=r.map((t,c)=>[t,c]);return l.sort((t,c)=>{const d=s(t[0],c[0]);return d!==0?d:t[1]-c[1]}),r=l.map(t=>t[0]),i&&(r=r.filter(t=>t.name.toLowerCase().indexOf(i.toLowerCase())!==-1)),r}function H({order:r,orderBy:s,rowCount:i,headLabel:l,numSelected:t,onRequestSort:c}){const d=o=>m=>{c(m,o)};return e.jsx(xe,{children:e.jsx(S,{children:l.map(o=>e.jsx(x,{align:o.align||"left",sortDirection:s===o.id?r:!1,sx:{width:o.width,minWidth:o.minWidth},children:e.jsxs(me,{hideSortIcon:!0,active:s===o.id,direction:s===o.id?r:"asc",onClick:d(o.id),children:[o.label,s===o.id?e.jsx(re,{sx:{...Le},children:r==="desc"?"sorted descending":"sorted ascending"}):null]})},o.id))})})}H.propTypes={order:a.oneOf(["asc","desc"]),orderBy:a.string,rowCount:a.number,headLabel:a.array,numSelected:a.number,onRequestSort:a.func};function Pe(){var D,O;const r=se(),s=F(n=>n.loan),i=F(n=>n),l=(O=(D=i==null?void 0:i.auth.user)==null?void 0:D.data)==null?void 0:O.token,t=s==null?void 0:s.loanMetrics;function c(n){return n/100}const d=(s==null?void 0:s.loans)||[],o=d==null?void 0:d.map((n,p)=>{const L={creditId:n.id,lender:n.lender_first_name,borrower:n.borrower_first_name,loanAmount:c(n.amount),expectedReturn:c(n.expected_return),balance:(c(n.expected_return)??0)-(c(n==null?void 0:n.amount_paid)??0),initiationDate:n.createdAt,dueDate:n.due_date,status:n.status?"completed":"active"};return L.index=p,L}),[m,w]=u.useState(""),[f,g]=u.useState(0),[b,T]=u.useState("asc"),[P,U]=u.useState("name"),[I,Ie]=u.useState(""),[y,K]=u.useState(5),J=(n,p)=>{p!==""&&(T(P===p&&b==="asc"?"desc":"asc"),U(p))},_=(n,p)=>{g(p)},$=n=>{g(0),K(parseInt(n.target.value,10))},R=Se({inputData:o,comparator:Ce(b,P),filterName:I}),Q=!R.length&&!!I,[v,V]=u.useState("");u.useEffect(()=>{let n;return v.trim()!==""&&(clearTimeout(n),n=setTimeout(()=>{r(oe({creditid:v,token:l}))},2e3)),()=>{clearTimeout(n)}},[v,r,l]);const X=n=>{V(n.target.value)},Y=n=>{w(n)};return u.useEffect(()=>{r(ie({item:m,token:l}))},[m,r,l]),u.useEffect(()=>{r(ae(l)),r(ce(l))},[r,l]),e.jsxs(Te,{children:[e.jsx(le,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(C,{variant:"h4",children:"Loans"})}),e.jsxs(h,{container:!0,spacing:2,sx:{margin:"1rem 0 4rem 0"},children:[e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Total no. of loans",total:((t==null?void 0:t.loans_active)||0)+((t==null?void 0:t.loans_due)||0)+((t==null?void 0:t.loans_pending)||0)+((t==null?void 0:t.loans_completed)||0),color:"info"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"No. Of Over Due Loans",total:(t==null?void 0:t.loans_due)||.001,color:"error"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Amount Of Loans Initiated By Lender",total:c(t==null?void 0:t.total_amount_initiated_lender)||.001,color:"warning"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"No. Of Pending Loans",total:(t==null?void 0:t.loans_pending)||.001,color:"success"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"No. Completed Loans",total:(t==null?void 0:t.loans_completed)||.001,color:"success"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"Amount Of Loans Initiated By Borrower",total:c(t==null?void 0:t.total_amount_initiated_borrower)||.001,color:"success"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"No. Of Active Loans",total:(t==null?void 0:t.loans_active)||.001,color:"info"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"No. Of Loans Initiated By Lender",total:(t==null?void 0:t.lender_initiated)||.001,color:"info"})}),e.jsx(h,{xs:12,sm:6,md:4,children:e.jsx(j,{title:"No. Of Loans Initiated By Borrower",total:(t==null?void 0:t.borrower_initiated)||.001,color:"info"})})]}),e.jsxs(ve,{children:[e.jsx(q,{setPostStatus:Y,filterName:v,onFilterName:X}),e.jsx(de,{children:e.jsx(he,{sx:{overflow:"unset"},children:e.jsxs(pe,{sx:{minWidth:800},children:[e.jsx(H,{order:b,orderBy:P,rowCount:o==null?void 0:o.length,onRequestSort:J,headLabel:[{id:"creditId",label:"Credit ID",align:"center"},{id:"lender",label:"Lender"},{id:"borrower",label:"Borrower"},{id:"loanAmount",label:"Loan Amount"},{id:"expectedReturn",label:"Expected Return"},{id:"balance",label:"Balance",align:"center"},{id:"initiationDate",label:"Initiation Date",align:"center"},{id:"dueDate",label:"Due Date"},{id:"status",label:"Status"},{id:""}]}),e.jsxs(je,{children:[R.slice(f*y,f*y+y).map(n=>e.jsx(z,{creditId:n.creditId,lender:n.lender,borrower:n.borrower,loanAmount:n.loanAmount,expectedReturn:n.expectedReturn,status:n.status,balance:n.balance,initiationDate:n.initiationDate,dueDate:n.dueDate},n.creaditId)),e.jsx(W,{height:77,emptyRows:Ne(f,y,o==null?void 0:o.length)}),Q&&e.jsx(M,{query:I})]})]})})}),e.jsx(fe,{page:f,component:"div",count:o==null?void 0:o.length,rowsPerPage:y,onPageChange:_,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:$})]})]})}function Je(){return e.jsxs(e.Fragment,{children:[e.jsx(ue,{children:e.jsx("title",{children:" Reviel | Loan List "})}),e.jsx(Pe,{})]})}export{Je as default};
